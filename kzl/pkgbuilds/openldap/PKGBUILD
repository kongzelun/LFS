# Maintainer: Zelun Kong <zelun.kong@outlook.com>

pkgname=openldap
pkgver=2.4.55
pkgrel=1
epoch=1
arch=('x86_64')
url="https://www.openldap.org"
depends=(libsasl)
provides=(libldap)
conflicts=(openldap libldap)
replaces=(openldap libldap)
backup=(etc/openldap/ldap.conf)
source=($url/software/download/OpenLDAP/openldap-release/openldap-$pkgver.tgz)
sha256sums=('97357bd6ba8ff73d204c1f8208c5e6ab97d60c9e779f989057aa1229bbe98434')

build() {
  cd $pkgbase-$pkgver

  ./configure \
    --prefix=/usr \
    --sbindir=/usr/bin \
    --libexecdir=/usr/lib \
    --sysconfdir=/etc \
    --localstatedir=/var/lib/openldap \
    --disable-debug \
    --enable-dynamic \
    --enable-syslog \
    --enable-ipv6 \
    --enable-local \
    --disable-slapd \
    --enable-crypt \
    --enable-spasswd \
    --enable-modules \
    --enable-backends=mod \
    --enable-overlays=mod \
    --with-cyrus-sasl \
    --with-threads

  make depend
  make
}

package() {
  cd $pkgbase-$pkgver

  make DESTDIR="$pkgdir/" install
}
