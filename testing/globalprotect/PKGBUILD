# Maintainer: zelun.kong@outlook.com

pkgname=globalprotect
pkgver=5.1.0
pkgrel=1
pkgdesc='Global Protect UI'
arch=(x86_64)
url='https://utdallas.box.com/s/sn3ardilya3oue3jn2esu9r3yjtsdn5d'
conflicts=(globalprotect-gui)
options=(!strip !docs !libtool staticlibs emptydirs zipman purge !debug)
install=globalprotect.install
source=(GlobalProtect_tar-5.1.0.0-101.tar.gz)
sha256sums=('eb0971935314028d7d8c858e379223cc6b352ec8ae3781b52cac00418f92b921')

package() {
  install -dm755 "$pkgdir"/opt/paloaltonetworks/globalprotect/
  install -Dm755 globalprotect PanGPA PanGPS PanGpHip PanGpHipMp "$pkgdir"/opt/paloaltonetworks/globalprotect/
  install -Dm644 *.so* "$pkgdir"/opt/paloaltonetworks/globalprotect/
  install -Dm644 license.cfg "$pkgdir"/opt/paloaltonetworks/globalprotect/
  install -Dm644 gpd gpd.service pangps.xml "$pkgdir"/opt/paloaltonetworks/globalprotect/
  install -Dm755 PanMSInit.sh pre_exec_gps.sh gpshow.sh gp_support.sh "$pkgdir"/opt/paloaltonetworks/globalprotect/
  
  install -dm755 "$pkgdir"/usr/share/man/man1/
  install -Dm644 globalprotect.1.gz "$pkgdir"/usr/share/man/man1/

  # Enable gp service
  install -Dm644 gpd.service "$pkgdir"/usr/lib/systemd/system/gpd.service

  # Ensure symbol link for GPI
  install -dm755 "$pkgdir"/usr/bin/
  ln -s /opt/paloaltonetworks/globalprotect/globalprotect "$pkgdir"/usr/bin/globalprotect

  # Enable autostart
  install -dm755 "$pkgdir"/etc/profile.d/
  install -Dm755 PanMSInit.sh "$pkgdir"/etc/profile.d/
}
